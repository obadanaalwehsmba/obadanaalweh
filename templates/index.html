<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Free Text to Speech - Multilingual AI Voice Generator</title>
  <!-- Other meta tags and script references -->
  <style>
    /* Same styles as before */
  </style>
</head>
<body>
  <div class="container">
    <h1>Free Text to Speech</h1>
    <div class="note">
      Note: The audio file will automatically download. Do not reload the page and ensure browser permissions allow downloads.
    </div>
    <form method="POST" action="/">
      <label for="language">Select Language:</label>
      <select name="language" id="language" required>
        {% for language, voices in voices_data.items() %}
          <option value="{{ language }}">{{ language }}</option>
        {% endfor %}
      </select>

      <label for="voice">Select Voice:</label>
      <select name="voice" id="voice" required>
        <!-- Voices populated by JavaScript -->
      </select>

      <label for="text">Enter Text:</label>
      <textarea name="text" id="text" rows="4" placeholder="Type your text here..." required></textarea>

      <button type="submit" name="convert">Convert to Speech</button>
      <button type="button" id="preview-example">Preview Voice</button>
      <button type="button" id="donate-now" onclick="window.location.href='https://www.patreon.com/preview/campaign?u=150716712&fan_landing=true&view_as=public'">Donate Now</button>
    </form>
    
    {% if file_url %}
      <a href="{{ file_url }}" download>Click here to download your audio file</a>
    {% endif %}
    
    <footer>
      <p>If you like this service, please consider a donation to support the site.</p>
    </footer>
  </div>
  <script>
    document.getElementById('language').addEventListener('change', function() {
      var language = this.value;
      var voicesData = {{ voices_data | tojson }};
      var voices = voicesData[language] || [];
      var voiceSelect = document.getElementById('voice');
      voiceSelect.innerHTML = '';
      voices.forEach(function(voice) {
        var option = document.createElement('option');
        option.value = voice;
        option.textContent = voice;
        voiceSelect.appendChild(option);
      });
    });

    document.getElementById('language').dispatchEvent(new Event('change'));

    document.getElementById('preview-example').addEventListener('click', function () {
      var language = document.getElementById('language').value;
      var voice = document.getElementById('voice').value;
      var audio = new Audio(`/generate-audio?language=${encodeURIComponent(language)}&voice=${encodeURIComponent(voice)}`);
      audio.play();
    });
  </script>
</body>
</html>
